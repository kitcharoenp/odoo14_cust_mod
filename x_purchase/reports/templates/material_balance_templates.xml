<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <!-- see tax in odoo14/addons/account/views/report_invoice.xml -->
<template id="balance_material_report_by_wo_document">

  <t t-call="web.external_layout_background">
      <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>

      <t t-set="address">
          <div t-field="o.partner_id"
          t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
          <p t-if="o.partner_id.vat"><t t-esc="o.company_id.country_id.vat_label or 'Tax ID'"/>: <span t-field="o.partner_id.vat"/></p>
      </t>

        <div class="page">
          <h2>
            <span>Balance Material</span>
          </h2>
          <!-- include CSS  -->
          <style>
              /* --- Generic Restyling and Resets --- */
              body {
                  font-family:freeserif;
              }
              table, th, td {
                  font-size: 12px;
                  border: 1px solid #ababab !important;
                  margin-bottom: 0px !important;
                  border-collapse: collapse !important;
                  vertical-align: middle !important;
              }
              td {
                  padding: 3px !important;
              }
          </style>
            <div class="oe_structure"/>

            <!-- invoice -->
              <table class="table table-bordered" style="table-layout:auto">
                <tr>
                  <th class="col-xs-2"><strong>Project</strong></th>
                  <td colspan="3"><span t-field="o.x_project_id.name"/></td>
                </tr>
                <tr>
                  <th class="col-xs-2" style="background-color: #DEDEDE;"><strong>Service Ref.1</strong></th>
                  <td class="col-xs-4"><span t-field="o.x_service_ref1"/></td>
                  <th class="col-xs-2" style="background-color: #DEDEDE;"><strong>Service Ref.2</strong></th>
                  <td class="col-xs-4"><span t-field="o.x_service_ref2"/></td>
                </tr>
                <tr>
                  <th class="col-xs-2" style="background-color: #DEDEDE;"><strong>Source Document</strong></th>
                  <td class="col-xs-4"><span t-field="o.origin"/></td>
                  <th class="col-xs-2" style="background-color: #DEDEDE;"><strong>Sap Network</strong></th>
                  <td class="col-xs-4"><span t-field="o.x_sap_network"/></td>
                </tr>
                <tr>
                  <th class="col-xs-2"><strong>Description</strong></th>
                  <td colspan="3"><span t-field="o.x_description"/></td>
                </tr>

              </table>


            <h4>Items Information</h4>
            <table class="table table-condensed">
              <!-- table head  -->
                <thead>
                    <tr class="text-center" style="background-color: #a6a6a6;">
                        <th class="text-left"><strong>No.</strong></th>
                        <th class="text-center col-xs-4"><strong>Description</strong></th>
                        <th class="text-center" style="font-size: 9px;"><strong>Unit Price</strong></th>
                        <th class="text-center" style="font-size: 9px;"><strong>Req</strong></th>
                        <th class="text-center" style="font-size: 9px;"><strong>Ret</strong></th>
                        <th class="text-center"><strong>Total</strong></th>
                    </tr>
                </thead>

                <tbody>

                  <br/>
                  <h2>SQL Result - <span t-esc="material_balance_items['col']"/></h2>
                  <br/>

                </tbody>


            </table>

            <div class="oe_structure"/>
        </div>

        <div t-attf-class="footer">

              <!-- Signature -->
              <div class="row">
                <!-- prepare employee -->
                  <div class="col-3 text-center" >
                      <ul style="list-style-type: none; font-size:12px;">
                          <li>เจ้าหน้าที่ผู้ได้รับมอบอำนาจจากผู้รับจ้าง</li>
                          <li><br/><br/></li>
                          <li>________________</li>
                          <li><span t-esc="datetime.datetime.now().strftime('%d / %m / %Y')"/></li>
                          <li t-if="o.user_id"><span t-field="o.user_id.name"/></li>
                          <li t-if="o.partner_id"><span t-field="o.partner_id.name"/></li>
                      </ul>
                  </div>
                  <!-- department manager -->
                  <div class="col-3 text-center" >
                      <ul style="list-style-type: none; font-size:12px;">
                          <li>ผู้แทนผู้ควบคุมงาน</li>
                          <li><br/><br/><br/></li>
                          <li>________________</li>
                          <li>______/_____/_____</li>
                          <li t-if="o.x_requestor_id"><span t-field="o.x_requestor_id.name"/></li>
                          <li t-if="o.x_requestor_id"><span t-field="o.x_requestor_id.job_id.name"/></li>
                      </ul>
                  </div>
                  <!-- company accounting director -->
                  <div class="col-3 text-center" >
                      <ul style="list-style-type: none; font-size:12px;">
                          <li>วิศวกรผู้ควบคุมงาน</li>
                          <li><br/><br/><br/></li>
                          <li>________________</li>
                          <li>______/_____/_____</li>
                          <li t-if="o.x_verified_id"><span t-field="o.x_verified_id.name"/></li>
                          <li t-if="o.x_verified_id"><span t-field="o.x_verified_id.job_id.name"/></li>

                      </ul>
                  </div>
                  <!-- company managing director -->
                  <div class="col-3 text-center" >
                      <ul style="list-style-type: none; font-size:12px;">
                          <li>ผู้จัดการโครงการ</li>
                          <li><br/><br/><br/></li>
                          <li>________________</li>
                          <li>______/_____/_____</li>
                          <li t-if="o.x_manager_id"><span t-field="o.x_manager_id.name"/></li>
                          <li t-if="o.x_manager_id"><span t-field="o.x_manager_id.job_id.name"/></li>

                      </ul>
                  </div>
              </div><!-- /.row -->



        </div>
    </t>
</template>

<template id="report_material_balance">
  <t t-call="web.html_container">
    <t t-foreach="docs" t-as="o">
      <t t-if="not o" t-set="o" t-value="doc"/>

      <t t-if="not company">
        <!-- Multicompany -->
        <t t-if="company_id">
          <t t-set="company" t-value="company_id"/>
        </t>
        <t t-elif="o and 'company_id' in o">
          <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-else="else">
          <t t-set="company" t-value="res_company"/>
        </t>
      </t>

      <t  t-call="x_purchase.balance_material_report_by_wo_document"
        t-lang="o.partner_id.lang"
        />
      </t>
    </t>
  </template>

</odoo>
